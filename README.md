
<div align="center">
  
  ![logo](https://github.com/jinyngg/attendance-back/assets/96164211/3290b91d-e1f8-4ffb-9a28-06e21048e521)

</div>

</br>

## ğŸ“š í”„ë¡œì íŠ¸ (2023. 07. 24. ~ 2023. 08. 11.)

**ìˆœì–‘ê·¸ë£¹**ì˜ ì—°ì°¨ ë° ë‹¹ì§ì„ ê´€ë¦¬í•˜ëŠ” í”„ë¡œì íŠ¸ì…ë‹ˆë‹¤.

</br>

## ğŸ‘¨â€ğŸ‘¨â€ğŸ‘§â€ğŸ‘¦ íŒ€ì›

|![](https://avatars.githubusercontent.com/u/98010441?v=4)|![](https://avatars.githubusercontent.com/u/96164211?v=4)|![](https://avatars.githubusercontent.com/u/22290112?v=4)|
|:---:|:---:|:---:|
|[ì„ ì˜ˆì€](https://github.com/dpdmstjs)|[ì¥ì§„ì˜](https://github.com/jinyngg)|[ì •ì¤€í¬](https://github.com/JoonheeJeong)|
|**í´ë¼ì´ì–¸íŠ¸ í˜ì´ì§€**</br>í”„ë¡œí•„ ê´€ë¦¬ API ê°œë°œ</br>íŒŒì¼ ì—…ë¡œë“œ API ê°œë°œ|**í´ë¼ì´ì–¸íŠ¸ í˜ì´ì§€**</br>íšŒì›ê°€ì…, ë¡œê·¸ì¸ ê°œë°œ</br>ì¸ì¦/ì¸ê°€ API ê°œë°œ</br>ìŠ¤í”„ë§ ì‹œíë¦¬í‹° ì„¤ì •|**í´ë¼ì´ì–¸íŠ¸ í˜ì´ì§€**</br>ì—°ì°¨/ë‹¹ì§ API ê°œë°œ</br>(ì¡°íšŒ, ë“±ë¡, ìˆ˜ì •, ì·¨ì†Œ)
|**ê´€ë¦¬ì í˜ì´ì§€**</br>ì§ì› ê´€ë¦¬ API ê°œë°œ</br>ì—°ì°¨, ë‹¹ì§ API ê°œë°œ|**ìŠ¤ì¼€ì¥´ëŸ¬**</br>ì§ê¸‰ì— ë”°ë¥¸ ì—°ì°¨ ì§€ê¸‰ ìŠ¤ì¼€ì¥´ëŸ¬ ê°œë°œ|**AWS ì„œë²„ ì„¤ì •**</br>ì„œë²„ ë°°í¬</br>ì„œë²„ ë„ë©”ì¸ ì„¤ì •|


</br>

## ğŸ›  ë°±ì—”ë“œ ê¸°ìˆ  ìŠ¤íƒ

<div align="center">

  ![ê¸°ìˆ ìŠ¤íƒ](https://github.com/jinyngg/attendance-back/assets/96164211/8cd4f32e-1da4-4bea-9e5f-f5ac79c6929c)

</div>

<div align="center">
  
  <div>
    <img src="https://img.shields.io/badge/springboot-6DB33F?style=for-the-badge&logo=springboot&logoColor=white">
    <img src="https://img.shields.io/badge/spring Security-6DB33F?style=for-the-badge&logo=spring Security&logoColor=white">
    <img src="https://img.shields.io/badge/JPA-6DB33F?style=for-the-badge&logo=JPA&logoColor=white">
    <img src="https://img.shields.io/badge/mockito-25A162?style=for-the-badge&logo=&logoColor=white">
    <img src="https://img.shields.io/badge/Junit5-25A162?style=for-the-badge&logo=junit5&logoColor=white">
  </div>

  <div>
    <img src="https://img.shields.io/badge/SMTP-blue?style=for-the-badge&logo=&logoColor=white">
    <img src="https://img.shields.io/badge/Redis-red?style=for-the-badge&logo=Redis&logoColor=white">
    <img src="https://img.shields.io/badge/Lombok-red?style=for-the-badge&logo=&logoColor=white">
    <img src="https://img.shields.io/badge/JWT-000000?style=for-the-badge&logo=jsonwebtokens&logoColor=white">
    <img src="https://img.shields.io/badge/Postman-FF6C37?style=for-the-badge&logo=postman&logoColor=white">
    <img src="https://img.shields.io/badge/Swagger-85EA2D?style=for-the-badge&logo=Swagger&logoColor=white">
  </div>

  <div>
    <img src="https://img.shields.io/badge/MySql-4479A1?style=for-the-badge&logo=mysql&logoColor=white">
    <img src="https://img.shields.io/badge/H2-blue?style=for-the-badge&logo=&logoColor=white">
    <img src="https://img.shields.io/badge/QueryDsl-blue?style=for-the-badge&logo=&logoColor=white">
    <img src="https://img.shields.io/badge/AWS EC2-FF9900?style=for-the-badge&logo=amazon&logoColor=white">
    <img src="https://img.shields.io/badge/Gradle-02303A?style=for-the-badge&logo=Gradle&logoColor=white">
  </div>

</div>

</br>

## ğŸ’¾ ERD 

<div align="center">

  ![image](https://github.com/jinyngg/attendance-back/assets/96164211/0f2d7060-5263-4ac4-a88f-33bc9fb2c020)

</div>

</br>

## ğŸ“ í…Œì´ë¸” ì„¤ê³„

```sql
-- ì§ê¸‰(ì‚¬ì›, ëŒ€ë¦¬, ê³¼ì¥, ë¶€ì¥, ì°¨ì¥, ì „ë¬´, ìƒë¬´, ì‚¬ì¥ ë“±..)
CREATE TABLE position
(
    id         BIGINT PRIMARY KEY AUTO_INCREMENT,
    type       VARCHAR(50) NOT NULL UNIQUE,
    created_at TIMESTAMP   NOT NULL DEFAULT NOW(),
    updated_at TIMESTAMP   NOT NULL DEFAULT NOW()
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4;
```

```sql
-- íšŒì› ìƒíƒœ(ì…ì‚¬, í‡´ì‚¬, ì¬ì…ì‚¬, íœ´ì§, ìœ¡ì•„íœ´ì§, ë³µì§ ë“±..)
CREATE TABLE status
(
    id         BIGINT PRIMARY KEY AUTO_INCREMENT,
    type       VARCHAR(20) NOT NULL UNIQUE,
    created_at TIMESTAMP   NOT NULL DEFAULT NOW(),
    updated_at TIMESTAMP   NOT NULL DEFAULT NOW()
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4;
```

```sql
-- ë¶€ì„œ(ê°œë°œ, ê¸°íš, ì˜ì—…, ì¸ì‚¬, íšŒê³„, ë²•ë¬´ ë“±..)
CREATE TABLE department
(
    id         BIGINT PRIMARY KEY AUTO_INCREMENT,
    type       VARCHAR(20) NOT NULL UNIQUE,
    created_at TIMESTAMP   NOT NULL DEFAULT NOW(),
    updated_at TIMESTAMP   NOT NULL DEFAULT NOW()
);
```

```sql
-- ì—°ì°¨(ì§ê¸‰ ë³„ ì§€ê¸‰í•˜ëŠ” ì—°ì°¨ì˜ ê°œìˆ˜)
CREATE TABLE day_off_by_position
(
    id          BIGINT PRIMARY KEY AUTO_INCREMENT,
    position_id BIGINT    NOT NULL UNIQUE,
    amount      TINYINT   NOT NULL,
    created_at  TIMESTAMP NOT NULL DEFAULT NOW(),
    updated_at  TIMESTAMP NOT NULL DEFAULT NOW(),
    FOREIGN KEY (position_id) REFERENCES position (id)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4;
```

```sql
-- ì—°ì°¨(ì˜¤ì „ ë°˜ì°¨, ì˜¤í›„ ë°˜ì°¨, ì—°ì°¨, íŠ¹ë³„ íœ´ê°€)
CREATE TABLE day_off
(
    id          BIGINT PRIMARY KEY AUTO_INCREMENT,
    type        VARCHAR(20) NOT NULL UNIQUE,
    amount      FLOAT       NOT NULL,
    created_at  TIMESTAMP   NOT NULL DEFAULT NOW(),
    updated_at  TIMESTAMP   NOT NULL DEFAULT NOW()
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4;
```

```sql
-- íšŒì› í…Œì´ë¸” ìƒì„±
CREATE TABLE employee
(
    id                  BIGINT PRIMARY KEY AUTO_INCREMENT        COMMENT 'ID',
    auth_token          VARCHAR(36)   NOT NULL                   COMMENT 'ì¸ì¦ í† í°',
    position_id         BIGINT        NOT NULL                   COMMENT 'ì§ê¸‰ ID',
    department_id       BIGINT        NOT NULL                   COMMENT 'ë¶€ì„œ ID',
    status_id           BIGINT        NOT NULL                   COMMENT 'íšŒì›ìƒíƒœ ID',
    name                VARCHAR(100)  NOT NULL                   COMMENT 'ì´ë¦„',
    email               VARCHAR(100)  NOT NULL UNIQUE            COMMENT 'ì´ë©”ì¼',
    password            CHAR(60)      NOT NULL COLLATE ascii_bin COMMENT 'ë¹„ë°€ë²ˆí˜¸',
    profile_image_path  VARCHAR(255)                             COMMENT 'í”„ë¡œí•„ ì´ë¯¸ì§€', -- ì¶”ê°€ëœ ì¹¼ëŸ¼
    hire_date           DATE          NOT NULL                   COMMENT 'ì…ì‚¬ì¼',
    quit_date           DATE                                     COMMENT 'í‡´ì‚¬ì¼',
    day_off_remains     FLOAT         NOT NULL                   COMMENT 'ì”ì—¬ ì—°ì°¨ìˆ˜',
    role                VARCHAR(20)   NOT NULL                   COMMENT 'ê¶Œí•œ',
    phone               VARCHAR(60)   NOT NULL                   COMMENT 'ì „í™”ë²ˆí˜¸',
    birthdate           DATE                                     COMMENT 'ìƒë…„ì›”ì¼',
    zip_address         CHAR(5)                COLLATE ascii_bin COMMENT 'ìš°í¸ë²ˆí˜¸',
    road_address        VARCHAR(255)                             COMMENT 'ì£¼ì†Œ1(ë„ë¡œëª…)',
    detail_address      VARCHAR(255)                             COMMENT 'ì£¼ì†Œ2(ìƒì„¸ì£¼ì†Œ)',
    created_at          TIMESTAMP     NOT NULL DEFAULT NOW()     COMMENT 'ìƒì„±ì¼',
    updated_at          TIMESTAMP     NOT NULL DEFAULT NOW()     COMMENT 'ìˆ˜ì •ì¼',
    last_login_at       TIMESTAMP     DEFAULT NOW()              COMMENT 'ìµœì¢… ë¡œê·¸ì¸',
    FOREIGN KEY (position_id) REFERENCES position (id),     -- position í…Œì´ë¸”ì˜ id ì¹¼ëŸ¼ì„ ì°¸ì¡°
    FOREIGN KEY (department_id) REFERENCES department (id), -- department í…Œì´ë¸”ì˜ id ì¹¼ëŸ¼ì„ ì°¸ì¡°
    FOREIGN KEY (status_id) REFERENCES status (id)          -- status í…Œì´ë¸”ì˜ id ì¹¼ëŸ¼ì„ ì°¸ì¡°;
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4;
```

```sql
CREATE TABLE position_history
(
    id          BIGINT PRIMARY KEY AUTO_INCREMENT,
    employee_id BIGINT    NOT NULL,
    position_id BIGINT    NOT NULL,
    created_at  TIMESTAMP NOT NULL DEFAULT NOW(),
    updated_at  TIMESTAMP NOT NULL DEFAULT NOW(),
    FOREIGN KEY (employee_id) REFERENCES employee (id),
    FOREIGN KEY (position_id) REFERENCES position (id)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4;
```

```sql
CREATE TABLE department_history
(
    id            BIGINT PRIMARY KEY AUTO_INCREMENT,
    employee_id   BIGINT    NOT NULL,
    department_id BIGINT    NOT NULL,
    created_at    TIMESTAMP NOT NULL DEFAULT NOW(),
    updated_at    TIMESTAMP NOT NULL DEFAULT NOW(),
    FOREIGN KEY (employee_id) REFERENCES employee (id),
    FOREIGN KEY (department_id) REFERENCES department(id)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4;

-- íšŒì› ìƒíƒœ ì´ë ¥ í…Œì´ë¸” ìƒì„±
CREATE TABLE status_history
(
    id          BIGINT PRIMARY KEY AUTO_INCREMENT,
    employee_id BIGINT    NOT NULL,
    status_id   BIGINT    NOT NULL,
    created_at  TIMESTAMP NOT NULL DEFAULT NOW(),
    updated_at  TIMESTAMP NOT NULL DEFAULT NOW(),
    FOREIGN KEY (employee_id) REFERENCES employee (id),
    FOREIGN KEY (status_id) REFERENCES status (id)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4;
```

```sql
-- ì—°ì°¨ ë“±ë¡ìš”ì²­/ì‘ë‹µ ì´ë ¥
CREATE TABLE day_off_history
(
    id               BIGINT PRIMARY KEY AUTO_INCREMENT,
    employee_id      BIGINT       NOT NULL,
    day_off_id       BIGINT       NOT NULL,
    status           VARCHAR(20)  NOT NULL,
    start_date       DATE         NOT NULL,
    end_date         DATE         NOT NULL,
    total_amount     FLOAT        NOT NULL,
    reason           VARCHAR(100) NOT NULL,  -- 100ì ì´ë‚´ë¡œ ì‚¬ìœ ë¥¼ ì“¸ ìˆ˜ ìˆìŒ
    created_at       TIMESTAMP    NOT NULL DEFAULT NOW(),
    updated_at       TIMESTAMP    NOT NULL DEFAULT NOW(),
    FOREIGN KEY (employee_id) REFERENCES employee (id),
    FOREIGN KEY (day_off_id) REFERENCES day_off (id)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4;
```

```sql
-- ë‹¹ì§ í…Œì´ë¸” ìƒì„±
CREATE TABLE duty_history
(
    id          BIGINT PRIMARY KEY AUTO_INCREMENT,
    employee_id BIGINT       NOT NULL,
    status      VARCHAR(20)  NOT NULL,
    date        DATE         NOT NULL,
    created_at  TIMESTAMP    NOT NULL DEFAULT NOW(),
    updated_at  TIMESTAMP    NOT NULL DEFAULT NOW(),
    FOREIGN KEY (employee_id) REFERENCES employee (id)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4;
```

```sql
CREATE TABLE login_history (
    id          BIGINT PRIMARY KEY AUTO_INCREMENT,
    employee_id BIGINT NOT NULL,
    client_ip   VARCHAR(255),
    user_agent  VARCHAR(255),
    created_at  TIMESTAMP,
    updated_at  TIMESTAMP,
    FOREIGN KEY (employee_id) REFERENCES employee (id)
);
```

</br>

## ğŸ“• API ëª…ì„¸

<div align="center">

  ![APIì„¤ê³„](https://github.com/jinyngg/attendance-back/assets/96164211/928065b4-3fa0-413a-9a80-310343463b0c)

</div>

</br>

## ğŸ‘©â€ğŸ’» í˜‘ì—…

`ì´ìŠˆ ê´€ë¦¬`

<div align="center">
  
  ![image](https://github.com/jinyngg/attendance-back/assets/96164211/bf0cce2f-0c85-4965-88aa-000e63882010)

</div>

</br>

`Git-flow ì „ëµ`

<div align="center">
  
  ![image](https://github.com/jinyngg/attendance-back/assets/96164211/a79baee7-4154-42b5-8c5e-216e8db6d611)

</div>

## AWS ëª…ë ¹ì–´

**ë¹Œë“œ**

```shell
./gradlew clean build bootJar -x test
```

**ë¹Œë“œëœ ì•± jar ì„œë²„ì— ì „ë‹¬**

```shell
scp -i {KEYíŒŒì¼} ./build/libs/*.jar {í˜¸ìŠ¤íŠ¸ëª…}@{í˜¸ìŠ¤íŠ¸ì•„ì´í”¼}:{ì €ì¥ê²½ë¡œ}/{jar íŒŒì¼ëª…}.jar
```

**ì•± ë°±ê·¸ë¼ìš´ë“œë¡œ ë¬´ì¤‘ë‹¨ ì‹¤í–‰ ë° ë¡œê·¸ ì €ì¥**

```shell
nohup java -jar {jar íŒŒì¼ëª…}.jar > {ë¡œê·¸ íŒŒì¼ ê²½ë¡œ} &
```

**ì•± ë¡œê·¸ í™•ì¸**

```shell
tail -f -n 200 {ë¡œê·¸ íŒŒì¼ ê²½ë¡œ}
```

**ì•± í”„ë¡œì„¸ìŠ¤ ì¢…ë£Œ**

```shell
kill -9 $(ps -ef | grep {jar íŒŒì¼ëª…} | head -n 1 | cut -d ' ' -f 6) 
```

</br>

## ğŸ—‘ íŠ¸ëŸ¬ë¸” ìŠˆíŒ…
